# 스프링부트 동작원리

---

### ■ 내장 톰캣(Tomcat)을 가진다

- 톰캣을 따로 설치할 필요없이 바로 실행이 가능하다.
- Tomcat?

  > `아파치 톰캣`은 아파치 소프트웨어 재단에서 개발한 서블릿 컨테이너만 있는 `웹 애플리케이션 서버`이다. 톰캣은 웹 서버와 연동하여 실행할 수 있는 자바 환경을 제공하여 자바서버 페이지와 자바 서블릿이 실행할 수 있는 환경을 제공하고 있다.
  >

  아파치는 html, css, .png와 같은 정적 파일에 대한 요청에만 응답한다.

  아파치는 자바 코드를 포함한 요청에 대한 응답을 할 수 없다. (java코드를 읽을 수 없기 때문)

  자바코드가 포함된 파일(JSP) 요청이 들어올 시 제어권을 Tomcat에게 넘기고 톰캣은 자바파일을 컴파일한다. 톰캣은 컴파일 된 데이터를 html 문서로 변환하여 아파치에게 전달한다. 마지막으로 아파치는 톰캣에게 전달받은 html문서를 응답한다.

---

### ■  서블릿 컨테이너 (Servlet Container)

- **웹 애플리케이션 서버** 중에서 **HTTP요청을 받아 처리**하는 기초 역할을 한다.
- 대부분의 웹 프레임워크가 제공하는 기능은 **서블릿 컨테이너 위에서 동작**하는 `서블릿`, `필터`, `이벤트 리스너` 등을 적절하게 구현한 것이다.
- 즉, 사용자가 웹 프레임워크로 작성한 웹 애플리케이션은 서블릿 컨테이너 위에서 동작한다.
- **아파치 톰캣(Tomcat)**, **제티(Jetty)** 등이 서블릿 컨테이너 이다.

  ![출처 : [https://minwan1.github.io/2018/11/21/2018-11-21-jsp-springboot-동작과정/](https://minwan1.github.io/2018/11/21/2018-11-21-jsp-springboot-%EB%8F%99%EC%9E%91%EA%B3%BC%EC%A0%95/)](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d370be05-1ac9-4a77-a6cf-879e8837501a/Untitled.png)

  출처 : [https://minwan1.github.io/2018/11/21/2018-11-21-jsp-springboot-동작과정/](https://minwan1.github.io/2018/11/21/2018-11-21-jsp-springboot-%EB%8F%99%EC%9E%91%EA%B3%BC%EC%A0%95/)

  1. 클라리언트의 최초 요청 시 서블릿 객체를 생성한다. - init() 메서드 호출
  2. service() 메서드 호출 - POST, GET, PUT, DELETE 식별 (새로운 스레드가 생성되어 실행)
  3. POST, GET, PUT, DELETE 요청에 알맞은 메서드 호출
  4. 요청(request)에 대한 응답(response)이 완료되면 스레드는 종료 (제거하지 않음)
  5. 스레드에 생성에 제한이 걸려 대기중인 요청은 종료된 스레드를 재사용 (Pooling 기법)

    ---

  `Scale-up`: 컴퓨터의 성능을 높여 최대 스레드의 개수를 늘리는 방법

  `Scale-out`: 컴퓨터의 개수를 늘려 분산처리하는 방법

- 스프링은 URI 접근 방식만 허용 (URL로 특정한 파일 요청을 할 수 없다.)
  즉, 요청 시에는 무조건 자바를 거친다. (Tomcat을 거친다.)

## 알아두면 좋은 기타 개념 정리

---

### Socket 통신 VS Http 통신

- Socket 통신
    - `Socket`: 운영체제가 가지고 있음. 네트워크 상에서 돌아가는 두 개의 프로그램 간 양방향 통신의 하나의 엔드 포인트
    - 연결을 성공하면 소켓을 종료하고 스레드를 오픈하여 양방향 통신을 진행한다.
    - 소켓통신의 단점: 두 개의 프로그램간 연결이 끊어지지 않기 때문에 부하가 크다.

- Http 통신
    - html 확장자로 만들어진 문서를 필요한 사람에게 연결없이 제공하는 방식
    - `Stateless` 방식 사용

      A 프로그램에서 a.txt 파일을 요청 했을 때, 소켓에서 새로운 스레드를 생성하지 않고 a.txt파일을 응답하고 소켓을 끊는다.

    - Http 통신의 단점: 요청이 들어올 때마다 항상 새로운 프로그램이라고 인식한다.


### 솔리드 프로젝트(Soild)

- WWW(World Wide Wep)의 창시자인 팀버너스리가 주도하는 웹 탈중심화 프로젝트
- 데이터를 중앙 집중화 시키지 않고 분산 시키는 웹 블록체인과 유사함

### 시스템 콜

- 운영체제가 제공하는 인터페이스 커널영역의 기능을 사용자 모드가 사용 가능하게 함
- 응용 프로그램의 요청에 따라 커널에 접근하기 위한 인터페이스
- ex) Http 통신을 위해 운영체제가 가지고 있는 소켓을 사용하는 것